# ブラウザ操作とエラー修正ガイド

このプロジェクトでは、PlaywrightとChrome DevToolsを使用してブラウザ上で操作を行い、リアルタイムでエラーを修正することができます。

## 利用可能な機能

### 1. ブラウザテスト (`npm run browser:test`)

- アプリケーションの自動テスト
- スクリーンショット撮影
- 要素の存在確認
- ユーザー操作のシミュレーション

### 2. エラー監視 (`npm run browser:monitor`)

- リアルタイムエラー監視
- 自動エラー修正の試行
- エラーレポートの生成
- 継続的な監視

### 3. ブラウザデバッグ (`npm run browser:debug`)

- 統合デバッグセッション
- インタラクティブな操作
- 動画録画機能
- 詳細なエラー分析

## 使用方法

### 基本的な使用方法

1. **アプリケーションを起動**

   ```bash
   npm start
   ```

2. **別のターミナルでブラウザテストを実行**

   ```bash
   npm run browser:test
   ```

3. **エラー監視を開始**

   ```bash
   npm run browser:monitor
   ```

4. **統合デバッグセッションを開始**
   ```bash
   npm run browser:debug
   ```

### エラー修正の流れ

1. **エラー検出**
   - コンソールエラー
   - ネットワークエラー
   - ページエラー
   - 未処理のPromise拒否

2. **自動修正の試行**
   - 未定義変数の修正
   - ネットワーク接続の確認
   - 型定義の確認
   - 構文エラーの修正

3. **手動修正の支援**
   - エラーの詳細情報提供
   - 修正提案の表示
   - スクリーンショットでの状況確認

## 監視されるエラータイプ

### ConsoleError

- **説明**: ブラウザコンソールで発生するエラー
- **自動修正**: 未定義変数の検出と修正提案
- **例**: `ReferenceError: variable is not defined`

### NetworkError

- **説明**: ネットワークリクエストの失敗
- **自動修正**: 接続確認とエンドポイント検証
- **例**: `404 Not Found`, `500 Internal Server Error`

### PageError

- **説明**: ページレベルでのJavaScriptエラー
- **自動修正**: エラースタックの分析と修正提案
- **例**: `TypeError: Cannot read property of undefined`

### UnhandledRejection

- **説明**: 未処理のPromise拒否
- **自動修正**: Promiseチェーンの確認と修正提案
- **例**: `UnhandledPromiseRejectionWarning`

## 生成されるファイル

### スクリーンショット

- `debug-screenshots/` ディレクトリに保存
- エラー発生時の画面状態を記録
- ファイル名: `debug-screenshot-{type}-{timestamp}.png`

### 動画録画

- `debug-videos/` ディレクトリに保存
- ブラウザ操作の全過程を記録
- デバッグ時の動作確認に使用

### デバッグレポート

- `debug-report-{timestamp}.json` ファイル
- エラーの詳細情報
- 修正試行の結果
- セッション統計

## 高度な使用方法

### カスタムエラー修正

```javascript
// カスタムエラー修正ロジックを追加
const customFix = {
  description: "カスタム修正",
  action: async (error) => {
    // 修正ロジックを実装
    return true; // 修正成功
  },
};
```

### エラー監視のカスタマイズ

```javascript
// 特定のエラーパターンを監視
page.on("console", (msg) => {
  if (msg.text().includes("特定のエラー")) {
    // カスタム処理
  }
});
```

## トラブルシューティング

### ブラウザが起動しない場合

1. Chrome/Chromiumがインストールされているか確認
2. ポート8081が使用可能か確認
3. ファイアウォール設定を確認

### エラーが検出されない場合

1. アプリケーションが正常に起動しているか確認
2. コンソールログの設定を確認
3. ネットワーク接続を確認

### 自動修正が動作しない場合

1. エラーメッセージの形式を確認
2. 修正ロジックの実装を確認
3. 権限設定を確認

## ベストプラクティス

1. **定期的な監視**: 開発中は継続的にエラー監視を実行
2. **スクリーンショットの活用**: エラー発生時の状況を視覚的に確認
3. **レポートの分析**: 生成されたレポートを定期的に確認
4. **カスタム修正の追加**: プロジェクト固有のエラーパターンに対応

## サポート

問題が発生した場合は、以下を確認してください：

1. ログファイルの確認
2. 生成されたスクリーンショットの確認
3. デバッグレポートの分析
4. ネットワーク接続の確認


